<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict'

const request = require('request')

class LivechatAPIClient {

  /**
   * The constructor
   * @constructor
   * @param    {object} opts          Options for connecting to LiveChat
   * @property {string} opts.apiVersion The Api version to use in LiveChat (current version is 2 (as when this text is written))
   * @property {string} opts.username The LOGIN value used for authentication with LiveChat
   * @property {string} opts.password The API_KEY used for authentication with LiveChat
   * @property {string} opts.baseUrl  The base url to connect with LiveChat (default: https://api.livechatinc.com/)
   */
  constructor (opts) {

    if (!opts.username || !opts.password) {
      throw new Error('Needs username and/or password to work')
    }

    this.apiVersion = opts.apiVersion || 2
    this.username = opts.username
    this.password = opts.password
    this.baseUrl = opts.baseUrl || `https://api.livechatinc.com`
  }

  /**
   * Wrapper for making a request to the Vitec API
   * @param  {string} endpoint Endpoint to make the request against
   * @param  {string} method   What kind of HTTP verb we use (GET, POST, PUT)
   * @param  {object} data     An object with the additional data to supply
   * @return {Promise}
   */
  _doRequest (endpoint, method, data) {
    method = method || 'GET'

    return new Promise((resolve, reject) => {

      let requestObject = {
        uri: `${this.baseUrl}/${endpoint}`,
        method: method,
        auth: {
          username: this.username,
          password: this.password,
        },
        headers: {
          'X-API-Version': this.apiVersion,
        }
      }

      if (method === 'POST' || method === 'PUT') {
        requestObject = Object.assign(requestObject, {body: data}, {json: true})
      }

      request(requestObject, (error, response, body) => {
        if (error) {
          reject(error)
        } else {
          if (!requestObject.json &amp;&amp; response.headers['content-type'].indexOf('application/json') !== -1) {
            body = JSON.parse(body)
            if (body.errors)
              reject(body)

            resolve(body)
          } else {
            resolve(body)
          }
        }
      })
    })
  }

  /**
   * Get all agents
   * @return {array}                   An array of agent objects
   */
  async getAgents() {
    return this._doRequest('agents', 'GET')
  }

  /**
   * Get all greetings
   * @return {array}                   An array of greeting objects
   */
  async getGreetings() {
    return this._doRequest('greetings', 'GET')
  }

  /**
   * Get a single greeting
   * @return {array}                   An greeting object
   */
  async getGreeting(id) {
    if (!id) 
      return new Error('Greeting id missing')

    return this._doRequest(`greetings/${id}`, 'GET')
  }

  /**
   * Create a greeting
   * @return {object}                   An greeting object
   */
  async createGreeting(data) {
    if (!data) 
      return new Error('Greeting data missing')

    return this._doRequest(`greetings`, 'POST', data)
  }

  /**
   * Delete a greeting
   * @return {object}                   an object with status
   */
  async deleteGreeting(id) {
    if (!id) 
      return new Error('Greeting id missing')

    return this._doRequest(`greetings/${id}`, 'DELETE')
  }
}

module.exports = exports = LivechatAPIClient</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="LivechatAPIClient.html">LivechatAPIClient</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Aug 28 2018 11:37:53 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
